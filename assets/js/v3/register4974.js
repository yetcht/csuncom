var imgCode="",sliderval=document.getElementById("rg_imgslider");function Login(){window.location.href="/Account/Login"}function RegisterAgree(){layer.open({title:configData.Register.txt36,type:2,area:["820px","600px"],fix:!0,maxmin:!1,content:"/Account/RegisterAgreeMent"})}sliderval&&jigsaw.init({el:sliderval,width:269,title:configData.Login.txt60,onSuccess:function(){imgCode=$(sliderval).data("code"),imgCode=rsaEncrypt(imgCode)},onFail:function(){console.log("fail")}}),$(document).ready(function(){var a,n=$("#UserName"),t=$("#RegisterMobileAndEmailRequired").val(),r=$("#btnCode"),e=$("form[id='formRegister']"),i=$("#divCode");e.on("keyup","#UserName",function(){var e=n.val().trim();phoneNumberPattern.test(e)?("Email"!=$("#RegisterType").val()&&i.show(),1==t?($(".reg_phone").hide(),$(".reg_email").show()):($(".reg_phone").hide(),$(".reg_email").hide())):emailPattern.test(e)?(i.hide(),1==t?$(".reg_phone").show():$(".reg_phone").hide(),$(".reg_email").hide()):(i.hide(),$(".reg_phone").show(),$(".reg_email").show());n.val(e)}).on("keyup","#Phone",function(){phoneNumberPattern.test($(this).val())?($(".logintip").addClass("hidetip"),i.show(),0==t&&layer.tips("邮箱可选题","#Email",{tips:[1,"#0FA6D8"]})):i.hide()}).on("keyup","#Email",function(){emailPattern.test($(this).val())&&$(".logintip").addClass("hidetip")});var s;function o(){r.val(configData.Register.txt21+"("+a+"S)"),0<a&&a--,0===a&&(clearInterval(s),r.removeClass("btn-disabled"),r.addClass("btn-default"),r.val(configData.Register.txt13))}r.click(function(){var t,e=n.val(),i=(phoneNumberPattern.test(e)||(e=$("#Phone").val()),$(".logintip").children());if(!isNull(e))return isNull(imgCode)?(i[1].innerHTML=configData.Register.txt46,$(".logintip").removeClass("hidetip"),!1):void(r.hasClass("btn-default")&&($(".logintip").addClass("hidetip"),$("#SecurityCode").val(""),a=60,isCrawler(!0),t="RegImgCode",$.post("/Account/GetCode",{mobie:e,location:"register",imgCode:imgCode,imgCodeKey:t},function(e){"ok"===e?(layer.msg(configData.Register.txt4,{icon:1}),r.removeClass("btn-default"),r.addClass("btn-disabled"),s=setInterval(o,1e3)):(i[1].innerHTML=e,$(".logintip").removeClass("hidetip"),a=0),$.get("/Account/GetAuthCode?key="+t,function(e){$(sliderval).data("code",e),imgCode=rsaEncrypt(e)})})));layer.msg(configData.Register.txt20)})}),$(function(){$("input[type='checkbox']").iCheck({checkboxClass:"icheckbox_minimal-orange",radioClass:"iradio_minimal-orange",increaseArea:"20%"}),$("#formRegister").validate({submitHandler:function(){var t=$(".logintip").children(),e=$("#UserName").val(),i=$("#SecurityCode").val(),a=$("#Password").val(),n=$("#ConfirmPassword").val(),r=$("#RegisterType").val(),s="0"==$("#NotRegisterVerify").val(),o=$("#RegisterMobileAndEmailRequired").val(),l="",g="";if(isNull(e))return d(configData.Register.txt23),!1;if(50<e.length||e.length<6)return d("注册账号长度限制:6-50字符"),!1;if(chinesePattern.test(e))return d("账号不能存在中文"),!1;if("All"!=r&&!(-1<r.indexOf("Cus")))if(-1<r.indexOf("Sms")&&-1<r.indexOf("Email")){if(!emailPattern.test(e)&&!phoneNumberPattern.test(e))return d(configData.Register.txt24),!1}else if(-1<r.indexOf("Sms")){if(!phoneNumberPattern.test(e))return d(configData.Register.txt43),!1}else if(!emailPattern.test(e))return d(configData.Register.txt44),!1;if(l=$("#Phone").val(),g=$("#Email").val(),!isNull(l)&&!phoneNumberPattern.test(l))return d("请输入正确的手机号"),!1;if(!isNull(g)&&!emailPattern.test(g))return d("请输入正确的邮箱"),!1;if(1==o){if(isNull(l)&&phoneNumberPattern.test(e)&&(l=e),isNull(g)&&emailPattern.test(e)&&(g=e),isNull(l)||isNull(g))return d(configData.Register.txt53),!1}else phoneNumberPattern.test(e)?l=e:emailPattern.test(e)&&(g=e);return isNull(l)&&isNull(g)?(d(configData.Register.txt53),!1):isNull(imgCode)?(d(configData.Register.txt46),!1):isNull(a)?(d(configData.Register.txt25),!1):a.length<6?(d(configData.Register.txt29),!1):""==i&&s&&phoneNumberPattern.test(e)?(d(configData.Register.txt5),!1):""==n?(d(configData.Register.txt26),!1):n!=a?(d(configData.Register.txt27),!1):0==$("#AgreeMent").is(":checked")?(d(configData.Register.txt33),$(".logintip").removeClass("hidetip"),!1):(r={UserName:e,SecurityCode:i,Password:a,ConfirmPassword:n,InvitationCode:$("#InvitationCode").val(),PromoteCode:$("#PromoteCode").val(),CountryOrRegion:$("#CountryOrRegion").val(),MainProducts:$("#MainProducts").val(),ApplicationField:$("#ApplicationField").val(),Email:g,Phone:l,ImgCode:imgCode},void $.ajax({url:"/Account/Register",data:r,type:"post",dataType:"json",async:!0,beforeSend:function(){$("#btnRegister").addClass("btn-disabled").attr("type","button").val(configData.Register.txt31)},success:function(e){var t;"redirect"!=e.state?($("#btnRegister").removeClass("btn-disabled").attr("type","submit"),$("#btnRegister").val(configData.Register.txt18),"success"===e.state?(t=$.request("returnUrl"),isNull(t)?0<=e.message.indexOf("email")?location.href="/Account/Active?n="+g+"&t=2":0<=e.message.indexOf("mobie")&&(location.href="/Account/Active?n="+l+"&t=1"):location.href=t):(0<=e.message.indexOf("r2")?d(configData.Register.txt2):0<=e.message.indexOf("r1")?d(configData.Register.txt1):0<=e.message.indexOf("r5")?d(configData.Register.txt5):0<=e.message.indexOf("r4")?d(configData.Register.txt32):0<=e.message.indexOf("r6")?d(configData.Register.txt6):0<=e.message.indexOf("r7")?(d(configData.Register.txt7),setTimeout(function(){location.href="/Account/Active?n="+g+"&t=2"},3e3)):0<=e.message.indexOf("r8")?d(configData.Register.txt38):d(e.message),sliderval&&($.get("/Account/GetAuthCode?key=RegImgCode",function(e){$(sliderval).data("code",e)}),$(".refreshIcon").click()),imgCode="")):location.href="/"},error:function(){$("#btnRegister").removeClass("btn-disabled").attr("type","submit"),$("#btnRegister").val(configData.Register.txt18)}}));function d(e){t[1].innerHTML=e,$(".logintip").removeClass("hidetip")}}})}),$("#SecurityCode,#Password,#UserName").bind("input porpertychange",function(){$(".logintip").addClass("hidetip")}),$("#AgreeMent").on("ifClicked",function(){0==$("#AgreeMent").is(":checked")?$("#btnRegister").removeClass("btn-disabled").attr("type","submit"):$("#btnRegister").addClass("btn-disabled").attr("type","button")});